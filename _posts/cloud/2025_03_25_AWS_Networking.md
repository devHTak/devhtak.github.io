### 네트워킹
- IT에서는 자원 간 연결하여 통신하는 환경을 의미
- OSI 7Layer
  - Physical Layer: 하드웨어 전송 기술을 이루는 계층, 물리적으로 연결된 매체가 서로 데이터를 송수신할 수 있게 연결하고 유지하는 역할
  - Datalink Layer: 물리 계층에서 송수신되는 정보의 오류와 흐름 제어
  - Network Layer: 데이터를 목적까지 전달, 최적의 경로
  - Transport Layer: end to end, 유효성과 효율성 보장
  - Session Layer: 응용프로세스 통신을 관리하는 방법으로, 데이터 통신을 위한 논리적인 연결을 담당
  - Presentation Layer: 데이터 형식에 차이가 있을 때 데이터를 서로 이해할 수 있는 형태로 변환
  - Application Layer: 응용 프로세스와 직접 연계하여 실제 응용프로그램을 서비스하는 역할
- IP 주소와 서브넷
  - IP는 자원을 식별하는 고유한 주소
    - public ip: 실제 인터넷에서 사용하려고 인터넷 서비스 공급자(ISP)에서 제공하는 유일한 공인 IP
    - private ip: 인터넷이 아닌 독립된 네트워크 내부에서만 사용하려고 네트워크 관리자가 제공하는 사설 IP
  - 서브넷과 서브넷 마스크
    - 모든 네트워크는 하나의 네트워크로만 구성되어 있지 않다, 주체와 목적에 따라 부분 네트워크로 나누고 서로 연결하여 거대한 네트워크 환경을 이룬다.
    - 서브넷은 부분 네트워크를 의미하며, 서브넷 마스크는 서브넷을 구분하고 식별하기 위한 것
    - IP: 192.168.100.1, 192.168.100.2 => Subnet Mask: 255.255.255.0/24 (동일한 서브넷을 의미)
- 라우팅과 라우터
  - 라우팅은 통신을 수행할 때 목적지 경로를 선택하는 작업을 의미하여 이를 수행하는 장비를 라우터라 한다.
  - 라우터는 라우팅 테이블이라는 서브넷의 경로 리스트를 갖고 목적지 네트워크에 대한 최적 경로를 선택하여 전달하는 역할
  - TCP와 UDP
    - Transport Layer에 대표적인 프로토콜로 데이터 전송을 담당
    - TCP(Transmission Control Protocol)
      - 송수신 대상 간 연결을 맺고 데이터 전송 여부를 확인하여 전송하는 연결형 프로토콜로 신뢰성 있는 데이터 전송 보장
    - UDP(User Diagram Protocol)
      - 송수신 대상 간 연결 없이 전달하는 비연결형 프로토콜
    - 포트번호: TCP, UDP를 사용하는 응용 서ㅣㅂ스는 서로 구분할 수 있도록 포트 번호 사용

### AWS 네트워킹(Amazon VPC)
- AWS 리전 네트워킹 디자인
  - Region은 주요 도시의 데이터 센터를 군집화(clustering)하는 물리적인 위치를 의미하며 리전 내부에는 Transit Center와 availability zone 이 서로 연결되어 네트워크 환경을 이루고 있다
  - Intra-AZ
    - 리전 내부에는 논리적인 데이터 센터의 집합인 가용 영역이 여러개가 존재하며, 가용 영역에 존재하는 데이터 센터들은 100GE or 400GE(Gigabyte Ethernet)으로 상호 연결되어 네트워킹 환경 구성(데이터 센터 간 연결)
  - Inter-AZ
    - 리전 내부에 가용영역은 100KM 이내로 떨어져 있고, 이런 물리적 거리를 두는 이유는 정전이나 자연재해 같은 문제에 가용성을 유지하기 위함
    - 지리적으로 떨어져 있는 가용 영역끼리 연결되어 네트워킹 환경을 구성하고 있으며, 이런 가용영역 간 연결을 Inter-AZ라 한다
  - Transit center connection
    - 리전에서 외부 인터넷 구간과 통신이 필요할 때는 트랜짓 센터를 통해 통신
    - 내부에 있는 가용 영역들은 외부 인터넷 통신을 위핸 트랜짓 센터와 연결되어 네트워킹 환경을 구성
- AWS 글로벌 네트워크와 Edge POP(Point Of Presence)
  - 엣지 POP은 AWS 글로벌 네트워크라는 전용망을 활용하여 안정적으로 고성능 서비스를 제공하는 센터로 엣지 POP을 통해 글로벌 서비스 콘텐츠를 빠르게 제공할 수 있다
  - 엣지 로케이션과 리전별 엣지 캐시로 구성
  - 대표적인 서비스로 Amazon CloudFront, Amazon Route53, AWS Shield, AWS Global Accelerator 등이 있다.
- AWS Networking 서비스
  - 네트워크 기반
    - VPC: 사용자 전용 가상의 프라이빗 클라우드 네트워크로, 자원을 탄력적으로 활용하는 서비스 제공
    - Transit Gateway: 중앙 허브처럼 VPC와 온프레미스 네트워크를 연결하는 게이트웨이 역할
  - 엣지 네트워킹
    - Route53: AWS에서 제공하는 관리형 DNS 서비스로 도메인 등록, 라우팅, 상태 확인 등 제공
    - Global Accelerator: AWS 글로벌 네트워크를 통해 애플리케이션을 빠르고 안정적으로 사용할 수 있도록 가용성 및 성능 보장
  - 하이브리드 연결
    - Direct Connect: 온프레미스 환경에서 AWS와 전용 네트워크 연결 서비스 제공
    - Site-to-Site VPN: IPsec VPN 연결을 생성하여 암호화된 네트워클르 구성하는 서비스 제공

#### Amazon VPC(Virtual Private Cloud)
- 개인의 데이터 센터에서 네트워크 환경을 구성하는 것 처럼 사용자 정의로 구성된 가상의 프라이빗 클라우드 네트워크
- Amazon VPC 기본 구성 요소
  - Region 과 VPC
    - 리전마다 독립적으로 구성되어 있으며 리전 내에 여러 VPC를 생성할 수있고 독립적으로 분리된다.
  - 서브넷과 가용 영역
    - Amazon VPC라는 하나의 독립된 클라우드 네트워크에도 서브넷을 이용하여 분리된 네트워크로 구성할 수 있다.
    - 서브넷은 VPC 내 별도로 나누어진 네트워크, 서브넷은 반드시 하나의 가용 영역에 종속적으로 위치
    - VPC 네트워크 환경 구성에 따라 퍼블릭(외부 인터넷 통신이 가능한 네트워크 영역), 프라이빗(인터넷 구간과 연결되지 않은 폐쇄적인 네트워크 영역)으로 분류할 수 있다
  - IP CIDR
    - 네트워크에 할당할 수 있는 IP 주소 범위를 표현하는 방법으로 내부에 생성할 서브넷의 IP 주소 범위를 할당하기 위해 IP CIDR을 가지고 있으며, VPC 내 생성된 서브넷도 VPC의 IP CIDR에서 분할된 IP CIDR을 가지고 있다.
  - 가상 라우터와 라우팅 테이블
    - 네트워크 경로를 확인하여 트래픽을 전달하는 목적의 가상 라우터가 생성
    - 가상 라우터는 기본 라우팅 테이블을 보유하고 있으며 라우팅 테이블을 통해 네트워크 경로를 식별할 수 있다.
  - 보안 그룹과 네트워크 ACL
    - security group, ACL(access control list)를 제공하여 가상의 방화벽 기능을 제공
    - stateful, stateless: 보안 그룹은 이전 상태 정보를 기억하고 그 상태를 활용하는 stateful 접근 통제를 수행하여 ACL은 이전 상태 정보를 기억하지 않고 다음에 그 상태를 활용하지 않는 stateless로 수행
- Amazon VPC와 다른 네트워크 연결
  - 인터넷 게이트웨이
    - VPC는 프라이빗 환경으로 위부 인터넷 구간과 연결되지 않는 독립적인 네트워크이기 때문에 인터넷 게이트웨이라는 네트워킹 자원을 생성한 후 VPC와 연결하여 외부 인터넷과 통신
  - NAT(Network Address Translation) 게이트웨이
    - 프라이빗 서브넷에서 외부 인터넷으로 통신하는 관문 역할을 하며 NAT는 IP 주소를 변환하는 역할로 Private -> Public으로 변환
  - VPC 피어링
    - 서로 다른 VPC를 연결하는 기능으로 동일 리전뿐만 아니라 다른 리전에 위치한 VPC에 연결할 수 있고, 다른 계정까지 연결할 수 있다.
    - VPC 피어링 시 IP CIDR 블록이 중복될 경우 연결이 불가능한 제약이 있어 IP 주소 대역을 반드시 점검해야 한다.
  - 전송 게이트웨이
    - 중앙 집중형 라우터로 다수의 VPC, 온프레미스를 단일 지점으로 연결
  - 가상 프라이빗 게이트웨이
    - 관리형 AWS Site-to-Site VPN을 연결하거나 AWS Direct Connect로 온프레미스 환경 연결

### 부하분산 - Amazon ELB(Elastic Load Balancing)
- 부하분산(loadbalancing)
  - 서버-클라이언트 환경에서 서버가 클라이언트 요청을 받아 처리하는 과정에서 발생하는 부하에 대해 동일한 목적을 수행하는 다수의 서버에 분산 처리하는 기능
  - 로드 밸런서를 활용하여 서비스 안정화를 구현할 수 있다.
- Amazon ELB
  - 로드밸런싱 기능을 제공하며 EC2 인스턴스에서 운영중인 애플리케이션, 마이크로 서비스 또는 컨테이너 서비스로 유입되는 트래픽을 자동 분산 처리하는 기술
  - 여러 프로토콜을 제공하며 사용자가 같은 인스턴스에서 세션을 유지할 수 있도록 지원
- Amazon ELB 구성 요소
  - 로드밸런서
    - 트래픽을 대상 그룹에 있는 인스턴스로 분산
  - 대상 그룹
    - 분산할 대상의 집합을 정의하는 구성 요소, 대상 그룹의 인스턴스에 대해 정적 또는 동적으로 구성할 수 있으며 라우팅 규칙에 따라 요청을 받아들일 대상 그룹 선택
    - 정기적으로 확인하여 장애 발생 대상을 자동으로 제외하고 정상 동작하는 대상에만 요청 전달
  - 리스너
    - 사용할 포트와 프로토콜을 설정하는 구성 요소
    - 클라이언트 요청을 수신하고 해당 요청을 처리할 대상 그룹을 선택하는 역할
- Amazon ELB 동작 방식
  - 클라이언트 요청 수신
    - 로드밸런서에서 클라이언트 요청을 수신, 로드밸런서는 클라이언트와 요청을 유지하며 요청을 수신하려고 리스너를 등록함
  - 대상 그룹 선택
    - 수신한 클라이언트 요청을 처리할 대상 그룹 선택
    - 대상 그룹은 인스턴스, IP, 람다, ALB 등 여러 유형의 대상으로 구성
  - 트래픽 분산
    - 선택된 대상 그룹에서 요청을 처리할 대상을 선택하고 요청을 분산
    - 로드밸런서는 각 대상의 가용성 상태를 모니터링
  - 응답 반환
    - 분산된 요청을 대상에서 처리하면 클라이언트에 응답 반환
- Amazon ELB 교차 영역 로드 밸런싱
  - 여러 가용 영역에서 로드밸런서 노드를 실행하며, 각 노드는 가용영역 내 대상 그룹으로 요청을 분산
  - 여러 가용영역에 걸쳐 여러 대상이 존재한다면 기본적으로 동일한 비중으로 가용영역 내에 있는 대상으로 트래픽 분산하는데, 교차 영역 로드밸런싱을 사용하면 여러 가용 영역에 대해 효과적인 로드밸런싱이 가능하다
  - 가용영역과 무관하게 대상 자원의 비율을 고려하여 가용 영역을 교차할 수 있으며, ALB는 기본적으로 활성화/NLB는 비활성화되어 있으며 사용할 때 가용 영역 간에 통신 비용이 발생할 수 있다.
- Amazon ELB 종류
  - CLB(Classic Load Balancer)
    - L4, L7 프로토콜을 모두 지원
    - 고정 IP, Domain name으로 액세스할 수 있으나 서버의 기본 주소가 변경되면 로드밸런서를 새로 생성해야 하는 단점이 있다.
  - ALB(Application Load Balancer)
    - L7 로드밸런서로 다음과 같은 특징이 있다.
      - HTTP 헤더를 확인하여 다양한 라우팅 기능 제공 (경로 기반, 호스트 기반, 쿼리 문자열 기반)
      - 오토 스케일링과 함께 사용하여 확장성 있는 애플리케이션 구성 가능
      - 대상 그룹 내 인스턴스에 대해 상태 검사를 수행하고 문제 발생 시 자동으로 장애 조취 가능
      - Amazon CloudWatch Log와 통합되어 모니터링, 분석 가능
  - NLB(Network Load Balancer)
    - L4 로드밸런서로 TCP 레벨에서 유지하므로 대규모 트래픽을 처리할 수 있으며 다음과 같은 특징이 있다.
      - 높은 처리량, 빠른 응답 시간, 높은 가용성, IP 주소 보존(클라이언트 IP 보존, 고정IP 가능), 모니터링(Cloud Trail, CloudWatch Log)
  - GWLB(Gateway Load Balancer)
    - 네트워크 트래픽을 서드파티의 방화벽/어플라이언스 장비로부터 부하분산 처리
   
### DNS(Domain Name System) - (Amazon Route 53)
- IP 주소에 대해 Domain Name으로 접속할 수 있도록 매핑하여 사용하는 서비스
- 과정
  - 웹서버의 IP 주소를 도메인 주소로 사용하고자 도메인을 구매하고 등록하면 DNS 서버는 도메인명과 IP주소 정보를 기록
  - 사용자는 도메인명을 입력하면 DNS 서버에 의해 IP주소에 대해 응답을 받을 수 있고, 해당 IP 주소를 활용하여 통신
    - DNS 서버는 도메인 구조에 따라 DNS 해석기를 이용하여 루트네임서버, TLD, SLD에 순차적으로 접근한다.
- 도메인 구조
  - www.google.com(서브도메인.세컨드레벨도메인.탑레벨도메인)
- DNS 서버 종류
  - 루트 네임 서버: 루트 도메인을 관리하는 DNS 서버로 전세계 13개만 존재
  - TLD(Top Level Domain) 네임 서버
  - SLD(Second Level Domain) 네임 서버
  - DNS 해석기: 사용자와 네임 서버 사이에서 중계자 역할을 수행하는 목적으로 DNS 해석기가 있다.
    
#### Amazon Route 53
- DNS 프로토콜은 UDP 53 포트 번호를 사용하기 때문에 이를 착안하여 Amazon Route 53으로 명명
- 주요 기능
  - 도메인 이름 등록
    - Amazon Route 53은 도메인 등록대행소 역할을 함께 수행한다.
  - 호스팅 영역 생성
    - 호스트 영역을 생성하여 네임 서버를 관리할 수 있다. 
  - 레코드 작성
    - DNS 레코드를 정의하여 도메인에 대한 요청 처리 방법을 정의할 수 있는데, 이런 DNS 레코드는 다양한 형태의 라우팅 정책을 연결하여 도메인 요청에 대한 응답 방식을 정의할 수 있다.
- 라우팅 정책
  - 단순 라우팅 정책
    - 도메인에 대해 특정 대상을 지정하는 방식으로 여러 대상이 있으면 랜덤한 대상을 선택하고 응답
  - 가중치 기반 라우팅 정책
    - 대상의 가중치를 지정하여 비중에 따라 대상을 선택하고 응답(0~255 범위에서 설정 가능)
  - 지연 시간 기반 라우팅 정책
    - 다수의 리전에 대상 자원이 있으면 사용자와 인접한 리전을 기준으로 대상 자원의 리전까지 지연시간을 파악하여 낮은 지연시간의 대상을 선택하고 응답
  - 장애 조치 라우팅 정책
    - 다수의 대상 자원에 대해 액티브와 패시브로 분류하고 대상 상태를 주기적으로 검사하여 액티브 대상을 선택하고 응답
   
### CDN(Contents Delivery Network) - (Amazon CloudFront)
- 컨텐츠 제공자와 사용자가 지리적으로 멀리 떨어져 있는 환경에서 콘텐츠를 빠르게 전달하는 네트워크 기술
- 컨텐츠 형태가 대용량이나 실시간성을 요구하는 추세에서 컨텐츠를 빠르게 전달하는 것은 중요한 이슈가 되었다.
- CDN 환경
  - CDN이 없다면 컨텐츠를 가지고 있는 Origin Server에서 사용자에게 컨텐츠를 전달하게 되는 데, Origin Server에 높은 부하, 지연 시간 등이 발생한다.
  - CDN 기술 핵심은 캐시 서버를 지역적으로 분산하고 컨텐츠를 동기화하여 분산 처리함으로써 사용자는 인접한 캐시 서버로 컨텐츠를 전달받아 빠르고 효율적인 서비스를 제공받을 수 있다.
- CDN 캐싱 방식
  - 캐시 서버는 컨텐츠를 저장하는 캐싱을 수행할 때, 유연하게 관리하고자 expire time(ttl) 을 지정하여 일정 시간동안 컨텐츠를 유지하고 삭제하는 동작을 취한다. 
  - Cache Missing 상황
    - Cache Missing 판정을 하면 Origin Server에 컨텐츠를 요청하고, 오리진 서버는 원본 컨텐츠를 복제해 캐시 서버에 전달
    - 캐시 서버는 해당 컨텐츠를 캐싱하고 사용자에게 컨텐츠 전달 
  - Cache Hit 상황
    - Cache Hit 판정을 하면 개시 서버는 사용자에게 컨텐츠를 전달
  - 정적 캐싱
    - 변경되거나 수정되지 않는 컨텐츠로 일반적으로 이미지, CSS, JS 등을 웹사이트의 레이아웃을 구성하는 컨텐츠 대부분이 정적 컨텐츠로 정적 캐싱은 정적 컨텐츠를 캐싱하는 방식을 의미
  - 동적 캐싱
    - 동적 컨텐츠는 사용자 요청이나 정보에 따라 즉석에서 생성되는 컨텐츠로 통적 캐싱은 동적 컨텐츠를 캐싱하는 방식을 의미한다.
    - 동적 캐싱은 동적 컨텐츠가 요청할 때마다 변경이 되는 특징이 있기 때문에 컨텐츠를 보관하지 않고 Cache Miss 상태로 동작

#### Amazon CloudFront
- 전세계에 분포된 엣지 로케이션이라는 곳에 컨텐츠를 캐싱하고 사용자 요청에 따라 가장 지연 시간이 낮은 엣지 로케이션이 응답
- 글로벌 엣지 네트워크를 이용하여 오리진 대상의 컨텐츠를 전세계에 위치한 엣지 로케이션과 리전 엣지 캐시에 캐싱하여 CDN 서비스 제공
  - 48개국 90개 이상의 도시에 위치한 450개 이상의 엣지 로케이션을 두고있다(2023.04 기준)
- 구성 
  - 오리진
    - 원본 컨텐츠를 가지고 있는 대상으로 온프레미스의 일반 서버나 EC2, ELB, S3가 될 수 있다.
  - Distribution
    - 오리진과 엣지 중간에 컨텐츠를 배포하는 역할로 CloudFront와 독립적인 단위로 Web Distribution, RTMP Distribution(스트리밍 전용)으로 분류 
  - 리전 엣지 캐시
    - 큰 단위의 엣지 영역으로 오리진과 엣지 로케이션 사이 위치하며 엣지 로케이션에서 오리진 서버에 컨텐츠를 요청하는 상황을 줄여 효율적인 역할을 한다.
  - 엣지 로케이션
    - Distribution을 통해 배포되는 컨텐츠를 캐싱하는 작은 단위의 엣지 영역으로 사용자 입장에서 가장 인접한 엣지 로케이션이 컨텐츠를 전달  
- 기능
  - 정적 및 동적 컨텐츠 처리
  - HTTPS 기능
  - 다수의 오리진 선택 가능
  - 접근 제어
    
#### 출처
<img width="571" alt="image" src="https://github.com/user-attachments/assets/48df31c1-aa7e-4a51-82c5-e933d41323d1" />

- AWS 교과서(길벗) 중 3장, 4장, 7장 정리한 내용입니다.
