### 4장 가비지 컬렉션 이해하기
#### 마크 앤 스윕 소개
- 마크 앤 스윕 알고리즘은 할당된 객체 리스트를 사용하여, 회수되지 않은 객체들의 포인터를 유지하는 방식으로 동작
  - 할당된 리스트를 순회하며 마크 비트(mark bit)를 초기화합니다.
  - 힙으로의 모든 포인터를 시작점으로하여 접근 가능한 모든 객체를 찾습니다.
  - 도달한 각 객체에 마크 비트를 설정
  - 할당된 리스트를 순회하며 마크 비트가 설정되지 않은 객체에 대한 작업 진행
    - 힙에서 해당 객체의 메모리를 회수하여 자유 리스트에 다시 추가
    - 객체를 할당된 리스트에서 제거
- 활성 객체는 DFS로 탐색되며 이렇게 만들어진 객체의 그래프를 활성 객체 그래프라 한다.
  - 접근 가능한 객체의 추이적 폐쇄라 부르며 반대로 접근할 수 없는 객체는 죽은 객체라고 부른다.

#### 가비지 컬랙션 용어집
- STW (Stop The World)
  - 가비지 컬렉션 사이클이 진행되는 동안 모든 애플리케이션 스레드를 멈춰야 한다.
- 동시성
  - 가비지 컬렉션 스레드가 애플리케이션 스레드가 실행되는 동안에도 동작할 수 있다.
  - G1은 일부 동시성 측면을 가지고 있다.
- 병렬
  - 가비지 컬렉션 작업을 여러 스레드와 여러 코어를 사용해 실행한다.
- 이동
  - 이동형 컬렉터에서는 객체가 메모리 내에서 재배치될 수 있다.
- 압축
  - 압축 컬렉터는 메모리 단편화를 방지
- 대피
  - 가비지 컬렉션 사이클이 끝날 때, 수집된 영역은 완전히 비워지고, 모든 활성 객체가 다른 메모리 영역으로 이동 된다.

#### 핫스팟 런타임 소개
- 자바는 오직 오프셋 연산자를 사용하여 객체 참조에서 필드에 접근하거나 메서드를 호출할 수 있다.
- 자바의 메소드 호출은 항상 값 복사 방식으로 이뤄지며 객체 참조의 경우, 힙에 있는 객체의 주소가 복사된다.
- 런타임에서 객체 표현
  - 핫스팟은 런타임에 자바 객체를 oop(ordinary object pointer)라는 구조를 통해 표현 (C에서 포인터를 의미)
    - 해당 값을 통해 스택 프레임에서 자바 힙의 메모리 영역으로 연결
  - oop는 인스턴스를 표현하는 instanceOop, 배열을 표현하는 경우에는 arrayOop라고 부른다.
    - klass워드는 klass 메타데이터를 찾는 데 사용
- 가비지 컬렉션 루트
  - 가비지 컬렉션 루트는 메모리의 앵커 포인트(anchor point)로 특정 메모리 풀 외부에서 시작하여 해당 메모리 풀 내부를 가리키는 외부 포인터를 의미
  - 반면, 메모리 풀 내부에서 시작하여 같은 메모리 풀 내의 다른 위치를 가리키는 포인터는 내부 포인터로 간주

#### 할당과 수명 주기
- 자바 애플리케이션의 가비지 컬렉션 동작을 결정하는 두가지 주요 요인
  - 할당 속도
  - 객체의 수명 주기
- 할당 속도는 일정 시간동안 새로 생성된 객체가 사용하는 메모리의 양을 나타낸다.
  - JFR 같은 도구가 이를 제공할 수 있고 이를 사용하는 데 있어 성능에 영향을 미칠 가능성이 있다.
- 객체의 수명 주기는 측정/추정하기 어렵다.
  - 객체의 수명이 짧으면 동일한 물리적 메모리를 반복적으로 재사용할 수 있다.

#### 약한 세대 가설
- 자바 가상 머신과 유사한 소프트웨어 시스템에서 객체의 수명 분포는 이중 분포를 나타낸다.
- 대부분의 객체는 수명이 매우 짧은 반면, 일부 객체는 훨씬 더 긴 수명을 가지는 데, 힙이 두개의 별도 영역으로 나누어 가져야 한다.
  - eden, survive 0/1, old 영역으로 나뉜다.
- eden 영역에 마크 앤 스윕 컬렉션 사용
- 세대별 힙을 사용하는 주요 이점 중 하나는 죽은 객체를 수집하는 데 비용이 들지 않고, 관심 대상은 오직 활성 객체 뿐이다.

#### 핫스팟의 프로덕션 가비지 컬렉션 기술
- 스레드 로컬 할당
- 반구형 컬렉션
- 클래식 핫스팟 힙

#### 병렬 컬렉터

#### 할당의 역할

### 5장 고급 가비지 컬렉션

### 6장 자바 가상 머신에서 코드 실행
